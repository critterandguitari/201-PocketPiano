#N canvas 234 25 1103 748 10;
#X declare -path lib;
#X declare -lib hcs;
#X obj 150 645 catch~ outL;
#X obj 233 647 catch~ outR;
#X obj 181 706 dac~;
#X obj 46 57 declare -path lib;
#N canvas 71 120 1317 630 metronome 0;
#X obj 314 248 snapshot~;
#X obj 353 213 bang~;
#X obj 259 210 phasor~ 2;
#X obj 218 123 * 200;
#X obj 218 147 + 50;
#X obj 218 171 / 60;
#X obj 218 99 r tempo-knob;
#X obj 82 345 s global-bpm;
#X obj 312 362 * 360;
#X obj 312 384 i;
#N canvas 303 750 292 294 mstobpm 0;
#X obj 46 14 inlet;
#X obj 47 248 outlet;
#X obj 46 108 t b b;
#X obj 46 79 sel 0;
#X text 87 47 time 16th notes;
#X obj 46 145 timer;
#X obj 46 46 % 12;
#X obj 46 182 expr 30000 / $f1;
#X connect 0 0 6 0;
#X connect 2 0 5 0;
#X connect 2 1 5 1;
#X connect 3 0 2 0;
#X connect 5 0 7 0;
#X connect 6 0 3 0;
#X connect 7 0 1 0;
#X restore 658 576 pd mstobpm;
#X obj 704 628 r midi-clock-present;
#X obj 658 656 spigot 0;
#N canvas 465 190 616 494 average-bpm 0;
#X obj 98 20 inlet;
#X obj 360 226 + 1;
#X obj 251 189 t a b;
#X obj 330 224 f 0;
#X obj 48 185 array sum \$0-bpm-mean;
#X obj 98 42 t b a;
#X obj 48 229 + 0.499999;
#X obj 48 251 i;
#X obj 48 273 outlet;
#X obj 284 11 loadbang;
#X msg 284 33 const 120;
#X obj 251 280 array set \$0-bpm-mean 5;
#X obj 48 207 / 5;
#X obj 330 246 % 5;
#X obj 284 58 array define -k \$0-bpm-mean 5;
#A 0 120 120 120 120 120;
#X connect 0 0 5 0;
#X connect 1 0 3 1;
#X connect 2 0 11 0;
#X connect 2 1 3 0;
#X connect 3 0 1 0;
#X connect 3 0 13 0;
#X connect 4 0 12 0;
#X connect 5 0 4 0;
#X connect 5 1 2 0;
#X connect 6 0 7 0;
#X connect 7 0 8 0;
#X connect 9 0 10 0;
#X connect 10 0 14 0;
#X connect 12 0 6 0;
#X connect 13 0 11 1;
#X restore 658 599 pd average-bpm;
#X obj 995 175 delay 1000;
#X msg 922 194 1;
#X obj 836 120 t b b b b, f 25;
#X msg 995 150 stop;
#X msg 982 201 0;
#X obj 1008 295 s midi-clock-present;
#X obj 828 297 spigot 0;
#X obj 831 515 spigot 0;
#X obj 393 303 ==;
#X obj 394 277 r midi-clock-present;
#X obj 312 328 spigot 1, f 12;
#X obj 656 682 change -1;
#X obj 827 405 t f f;
#X obj 317 582 t f f;
#X obj 283 613 % 15;
#X obj 283 635 sel 0;
#X msg 895 317 0;
#X obj 858 459 midiclocker;
#X text 936 459 24 ppq in \, 360 ppq out;
#N canvas 0 23 450 300 count24 0;
#X obj 163 87 i;
#X obj 266 210 + 1;
#X obj 159 132 t f f;
#X obj 246 173 sel 23;
#X msg 207 210 0;
#X obj 131 244 outlet;
#X obj 125 40 inlet;
#X obj 251 34 inlet;
#X connect 0 0 2 0;
#X connect 1 0 0 1;
#X connect 2 0 5 0;
#X connect 2 1 3 0;
#X connect 3 0 4 0;
#X connect 3 1 1 0;
#X connect 4 0 0 1;
#X connect 6 0 0 0;
#X connect 7 0 0 1;
#X restore 828 346 pd count24;
#X obj 938 248 t a a;
#X obj 895 295 r midi-start-in;
#X obj 837 88 r midi-clock-in;
#X obj 394 658 s beat-clock;
#X obj 894 493 r midi-clock-present;
#X obj 283 657 s midi-clock-out;
#X obj 659 707 s global-bpm;
#X obj 165 281 ==;
#X obj 166 255 r midi-clock-present;
#X obj 84 306 spigot 1, f 12;
#X text 207 55 internal clock;
#X text 844 65 midi clock;
#X obj 311 427 clockfill;
#X obj 519 359 print CLOCKSTATUS;
#X obj 500 324 change;
#X text 381 599 send beat clock to patch \, then midi clock output, f 25;
#X connect 0 0 24 0;
#X connect 1 0 0 0;
#X connect 2 0 0 0;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 4 0 43 0;
#X connect 5 0 2 0;
#X connect 6 0 3 0;
#X connect 8 0 9 0;
#X connect 9 0 46 0;
#X connect 10 0 13 0;
#X connect 11 0 12 1;
#X connect 12 0 25 0;
#X connect 13 0 12 0;
#X connect 14 0 18 0;
#X connect 15 0 34 0;
#X connect 16 0 20 0;
#X connect 16 1 14 0;
#X connect 16 2 15 0;
#X connect 16 3 17 0;
#X connect 17 0 14 0;
#X connect 18 0 34 0;
#X connect 20 0 33 0;
#X connect 21 0 27 0;
#X connect 22 0 24 1;
#X connect 23 0 22 0;
#X connect 23 0 48 0;
#X connect 24 0 8 0;
#X connect 25 0 40 0;
#X connect 26 0 10 0;
#X connect 26 1 31 0;
#X connect 27 0 28 0;
#X connect 27 1 37 0;
#X connect 28 0 29 0;
#X connect 29 0 39 0;
#X connect 30 0 33 1;
#X connect 31 0 21 0;
#X connect 33 0 26 0;
#X connect 34 0 20 1;
#X connect 34 1 19 0;
#X connect 35 0 30 0;
#X connect 36 0 16 0;
#X connect 38 0 21 1;
#X connect 41 0 43 1;
#X connect 42 0 41 0;
#X connect 43 0 7 0;
#X connect 46 0 27 0;
#X connect 48 0 47 0;
#X restore 315 121 pd metronome;
#N canvas 116 113 880 532 init 0;
#X msg 145 167 \; pd dsp 1;
#X msg 223 199 1;
#X obj 220 257 s set-pattern-num;
#X obj 258 230 s set-synth-num;
#X obj 309 199 s latch-state;
#X msg 307 177 0;
#X obj 784 147 s osc-init;
#X obj 726 174 s load-synths;
#X obj 238 42 loadbang;
#X obj 684 212 s load-patterns;
#X obj 418 409 s load-songs;
#X obj 626 233 s load-midi-config;
#X obj 240 79 t b b b b b b b b b, f 55;
#X obj 48 181 s unmute-dac;
#X obj 526 423 symbol;
#X obj 526 444 s songs-root-path;
#X msg 539 388 /Users/owen1/repos/dirlist/testdirs;
#X msg 486 367 /sdcard/presets;
#X obj 236 161 t b b;
#X msg 259 201 1;
#X obj 523 309 s npmode;
#X msg 521 276 0;
#X msg 408 308 0;
#X obj 368 443 s cursong-index;
#X msg 402 166 mkdir /sdcard/presets;
#X text 698 308 create presets folder if no exist, f 19;
#X obj 403 192 shell;
#X obj 438 242 t b b b b, f 18;
#X connect 1 0 2 0;
#X connect 5 0 4 0;
#X connect 8 0 12 0;
#X connect 12 0 13 0;
#X connect 12 1 0 0;
#X connect 12 2 18 0;
#X connect 12 3 5 0;
#X connect 12 4 24 0;
#X connect 12 5 11 0;
#X connect 12 6 9 0;
#X connect 12 7 7 0;
#X connect 12 8 6 0;
#X connect 14 0 15 0;
#X connect 16 0 14 0;
#X connect 17 0 14 0;
#X connect 18 0 1 0;
#X connect 18 1 19 0;
#X connect 19 0 3 0;
#X connect 21 0 20 0;
#X connect 22 0 23 0;
#X connect 24 0 26 0;
#X connect 26 1 27 0;
#X connect 27 0 22 0;
#X connect 27 1 10 0;
#X connect 27 2 17 0;
#X connect 27 3 21 0;
#X restore 315 47 pd init;
#X obj 46 33 declare -lib hcs;
#X obj 591 47 v synth-num;
#X obj 591 69 v pattern-num;
#X obj 591 94 v seq-state;
#X obj 591 119 v latch-state;
#N canvas 127 296 838 425 leds 0;
#X obj 351 33 array define led1 3;
#X obj 351 55 array define led2 3;
#X obj 351 78 array define led3 3;
#N canvas 128 142 991 503 test 0;
#X obj 376 314 s oscOut;
#X obj 385 161 random 255;
#X obj 454 161 random 255;
#X obj 522 161 random 255;
#X obj 400 184 random 255;
#X obj 469 184 random 255;
#X obj 537 184 random 255;
#X obj 425 207 random 255;
#X obj 494 207 random 255;
#X obj 562 207 random 255;
#X obj 368 43 metro 250;
#X obj 384 89 t b b b b b b b b b, f 53;
#X obj 385 254 pack 0 0 0 0 0 0 0 0 0;
#X msg 377 293 send /leds \$1 \$2 \$3 \$4 \$5 \$6 \$7 \$8 \$9, f 65;
#X connect 1 0 12 0;
#X connect 2 0 12 3;
#X connect 3 0 12 6;
#X connect 4 0 12 1;
#X connect 5 0 12 4;
#X connect 6 0 12 7;
#X connect 7 0 12 2;
#X connect 8 0 12 5;
#X connect 9 0 12 8;
#X connect 11 0 1 0;
#X connect 11 1 4 0;
#X connect 11 2 7 0;
#X connect 11 3 2 0;
#X connect 11 4 5 0;
#X connect 11 5 8 0;
#X connect 11 6 3 0;
#X connect 11 7 6 0;
#X connect 11 8 9 0;
#X connect 12 0 13 0;
#X connect 13 0 0 0;
#X restore 496 74 pd test;
#X obj 483 106 r led-flip;
#X obj 326 190 array get led1;
#X obj 483 127 t b b b b b;
#X obj 424 191 array get led2;
#X obj 526 190 array get led3;
#X obj 325 217 unpack 0 0 0;
#X obj 424 217 unpack 0 0 0;
#X obj 526 216 unpack 0 0 0;
#X obj 327 302 s oscOut;
#N canvas 585 50 450 300 ledall 0;
#X obj 64 37 r ledall;
#X obj 27 110 s led1-set;
#X obj 102 109 s led2-set;
#X obj 177 116 s led3-set;
#X obj 64 65 t a a a, f 32;
#X connect 0 0 4 0;
#X connect 4 0 1 0;
#X connect 4 1 2 0;
#X connect 4 2 3 0;
#X restore 493 47 pd ledall;
#X obj 592 60 array set led1;
#X obj 592 37 r led1-set;
#X obj 593 79 r led2-set;
#X obj 593 102 array set led2;
#X obj 592 123 r led3-set;
#X obj 592 146 array set led3;
#X msg 323 273 send /leds \$1 \$2 \$3 \$4 \$5 \$6 \$7 \$8 \$9, f 65;
#X obj 324 249 pack 0 0 0 0 0 0 0 0 0, f 43;
#N canvas 62 44 1338 485 synth-leds 0;
#X obj 112 34 r synth-num;
#X obj 112 62 t b f;
#X obj 135 286 s led3-set;
#X obj 208 284 s led3-set;
#X obj 281 280 s led3-set;
#X obj 355 283 s led3-set;
#X obj 432 283 s led3-set;
#X obj 512 286 s led3-set;
#X obj 31 241 s led-flip;
#X obj 133 115 sel 1 2 3 4 5 6, f 44;
#X msg 157 189 54 6 127;
#X msg 308 195 0 8 85;
#X msg 372 196 0 69 9;
#X msg 520 215 71 1 1;
#X msg 447 204 71 16 1;
#X msg 224 193 127 0 72;
#X obj 622 142 t b b;
#X msg 645 248 100 100 100;
#X obj 608 293 s led-flip;
#X obj 676 79 r flash-all-leds;
#X obj 674 197 v synth-num;
#X obj 645 270 s led3-set;
#X obj 674 142 delay 150;
#X connect 0 0 1 0;
#X connect 1 0 8 0;
#X connect 1 1 9 0;
#X connect 9 0 10 0;
#X connect 9 1 15 0;
#X connect 9 2 11 0;
#X connect 9 3 12 0;
#X connect 9 4 14 0;
#X connect 9 5 13 0;
#X connect 10 0 2 0;
#X connect 11 0 4 0;
#X connect 12 0 5 0;
#X connect 13 0 7 0;
#X connect 14 0 6 0;
#X connect 15 0 3 0;
#X connect 16 0 18 0;
#X connect 16 1 17 0;
#X connect 17 0 21 0;
#X connect 19 0 16 0;
#X connect 19 0 22 0;
#X connect 20 0 1 0;
#X connect 22 0 20 0;
#X restore 106 49 pd synth-leds;
#N canvas 62 44 951 438 pattern-leds 0;
#X obj 112 62 t b f;
#X obj 55 234 s led-flip;
#X obj 140 112 sel 1 2 3 4 5 6, f 44;
#X obj 129 233 s led2-set;
#X obj 202 231 s led2-set;
#X obj 275 227 s led2-set;
#X obj 349 230 s led2-set;
#X obj 426 230 s led2-set;
#X obj 506 233 s led2-set;
#X obj 112 34 r pattern-num;
#X msg 133 168 54 6 127;
#X msg 284 174 0 8 85;
#X msg 348 175 0 69 9;
#X msg 496 194 71 1 1;
#X msg 423 183 71 16 1;
#X msg 200 172 127 0 72;
#X obj 584 115 t b b;
#X msg 607 221 100 100 100;
#X obj 570 266 s led-flip;
#X obj 617 61 r flash-all-leds;
#X obj 636 170 v pattern-num;
#X obj 607 243 s led2-set;
#X obj 636 115 delay 150;
#X connect 0 0 1 0;
#X connect 0 1 2 0;
#X connect 2 0 10 0;
#X connect 2 1 15 0;
#X connect 2 2 11 0;
#X connect 2 3 12 0;
#X connect 2 4 14 0;
#X connect 2 5 13 0;
#X connect 9 0 0 0;
#X connect 10 0 3 0;
#X connect 11 0 5 0;
#X connect 12 0 6 0;
#X connect 13 0 8 0;
#X connect 14 0 7 0;
#X connect 15 0 4 0;
#X connect 16 0 18 0;
#X connect 16 1 17 0;
#X connect 17 0 21 0;
#X connect 19 0 16 0;
#X connect 19 0 22 0;
#X connect 20 0 0 0;
#X connect 22 0 20 0;
#X restore 106 77 pd pattern-leds;
#N canvas 108 101 936 676 seq-leds 0;
#X obj 155 255 t b f;
#X obj 49 493 s led-flip;
#X obj 87 127 r seq-state;
#X obj 183 371 sel 0 3 6 1, f 44;
#X obj 170 573 s led1-set;
#X obj 245 490 s led1-set;
#X obj 318 486 s led1-set;
#X obj 392 489 s led1-set;
#X msg 146 515 0 0 0;
#X msg 245 468 0 100 0;
#X msg 318 464 50 0 50;
#X msg 392 467 100 0 0;
#X obj 499 82 sel 0;
#X obj 492 47 r beat-clock;
#X text 576 46 tick the arps 1 tick late to ensure seq starts first;
#X obj 557 183 v seq-state;
#X obj 505 128 t b b;
#X obj 528 256 s led1-set;
#X msg 528 234 100 100 100;
#X obj 491 279 s led-flip;
#X text 67 103 led colors for seq state;
#X obj 697 72 r flash-all-leds;
#X obj 557 128 delay 30;
#X obj 157 468 sel 0 1;
#X msg 220 516 0 2 2;
#X obj 335 131 r latch-state;
#X obj 176 432 i;
#X obj 305 194 v seq-state;
#X obj 322 161 t b f;
#X text 280 84 latch state changes led color;
#X text 301 103 but only in the stopped state;
#X obj 638 128 delay 150;
#X connect 0 0 1 0;
#X connect 0 1 3 0;
#X connect 2 0 0 0;
#X connect 3 0 26 0;
#X connect 3 1 9 0;
#X connect 3 2 10 0;
#X connect 3 3 11 0;
#X connect 8 0 4 0;
#X connect 9 0 5 0;
#X connect 10 0 6 0;
#X connect 11 0 7 0;
#X connect 12 0 16 0;
#X connect 12 0 22 0;
#X connect 13 0 12 0;
#X connect 15 0 0 0;
#X connect 16 0 19 0;
#X connect 16 1 18 0;
#X connect 18 0 17 0;
#X connect 21 0 16 0;
#X connect 21 0 31 0;
#X connect 22 0 15 0;
#X connect 23 0 8 0;
#X connect 23 1 24 0;
#X connect 24 0 4 0;
#X connect 25 0 28 0;
#X connect 26 0 23 0;
#X connect 27 0 0 0;
#X connect 28 0 27 0;
#X connect 28 1 26 1;
#X connect 31 0 15 0;
#X restore 106 25 pd seq-leds;
#X connect 4 0 6 0;
#X connect 5 0 9 0;
#X connect 6 0 5 0;
#X connect 6 1 7 0;
#X connect 6 2 8 0;
#X connect 7 0 10 0;
#X connect 8 0 11 0;
#X connect 9 0 21 0;
#X connect 9 1 21 1;
#X connect 9 2 21 2;
#X connect 10 0 21 3;
#X connect 10 1 21 4;
#X connect 10 2 21 5;
#X connect 11 0 21 6;
#X connect 11 1 21 7;
#X connect 11 2 21 8;
#X connect 15 0 14 0;
#X connect 16 0 17 0;
#X connect 18 0 19 0;
#X connect 20 0 12 0;
#X connect 21 0 20 0;
#X restore 315 96 pd leds;
#N canvas 328 174 667 525 synth-select 0;
#X obj 66 37 stripnote;
#X obj 66 13 r shift-keys;
#X obj 65 82 sel 11 12 14 16 17 19, f 26;
#X text 281 199 speed limit 20 ms to allow for fade out/in;
#X msg 79 125 1, f 2;
#X msg 115 124 2, f 2;
#X msg 156 126 3, f 2;
#X msg 199 125 4, f 2;
#X msg 233 124 5, f 2;
#X msg 280 125 6, f 2;
#N canvas 133 296 450 344 20ms-speed-limit 0;
#X msg 91 120 1;
#X obj 85 180 spigot 1;
#X msg 159 118 0;
#X obj 92 95 delay 20;
#X obj 45 27 inlet;
#X obj 139 55 t b b;
#X obj 71 242 t f b;
#X obj 62 277 outlet;
#X connect 0 0 1 1;
#X connect 1 0 6 0;
#X connect 2 0 1 1;
#X connect 3 0 0 0;
#X connect 4 0 1 0;
#X connect 5 0 3 0;
#X connect 5 1 2 0;
#X connect 6 0 7 0;
#X connect 6 1 5 0;
#X restore 129 198 pd 20ms-speed-limit;
#X obj 92 344 delay 10;
#X msg 111 438 1;
#X obj 115 380 f;
#X obj 147 315 t b f;
#X obj 111 465 s, f 10;
#X obj 141 404 t b f;
#X obj 192 296 s synth-num;
#X text 445 289 turn off with fadeout;
#X obj 301 290 s synth-disable-all;
#X text 177 345 enable after 10ms for fade out;
#X msg 191 427 symbol s\$1-enable;
#X obj 151 240 t f f b;
#X obj 349 134 r set-synth-num;
#X connect 0 0 2 0;
#X connect 1 0 0 0;
#X connect 2 0 4 0;
#X connect 2 1 5 0;
#X connect 2 2 6 0;
#X connect 2 3 7 0;
#X connect 2 4 8 0;
#X connect 2 5 9 0;
#X connect 4 0 10 0;
#X connect 5 0 10 0;
#X connect 6 0 10 0;
#X connect 7 0 10 0;
#X connect 8 0 10 0;
#X connect 9 0 10 0;
#X connect 10 0 22 0;
#X connect 11 0 13 0;
#X connect 12 0 15 0;
#X connect 13 0 16 0;
#X connect 14 0 11 0;
#X connect 14 1 13 1;
#X connect 16 0 12 0;
#X connect 16 1 21 0;
#X connect 21 0 15 1;
#X connect 22 0 14 0;
#X connect 22 1 17 0;
#X connect 22 2 19 0;
#X connect 23 0 10 0;
#X restore 315 169 pd synth-select;
#X obj 136 293 r keys;
#X obj 590 143 v click-state;
#X text 694 47 the currently selected synth;
#X text 696 69 the currently selected pattern gen;
#X text 700 121 1 = latch mode on \, 0 = off;
#X text 700 145 1 = metronome click on \, 0 = off;
#N canvas 162 204 615 422 shift-keys 0;
#X obj 187 52 r shift;
#X obj 202 204 s shift-keys;
#N canvas 72 279 450 300 switch 0;
#X obj 226 121 ==;
#X obj 93 183 spigot 1;
#X obj 164 182 spigot 0;
#X obj 248 91 t f f;
#X obj 86 39 inlet;
#X obj 87 235 outlet;
#X obj 174 224 outlet;
#X obj 289 42 inlet;
#X connect 0 0 1 1;
#X connect 1 0 5 0;
#X connect 2 0 6 0;
#X connect 3 0 0 0;
#X connect 3 1 2 1;
#X connect 4 0 1 0;
#X connect 4 0 2 0;
#X connect 7 0 3 0;
#X restore 117 115 pd switch;
#X obj 141 282 bag;
#X msg 219 121 flush;
#X obj 187 84 t f b;
#X obj 141 310 pack 0 0;
#X obj 128 15 inlet;
#X obj 126 385 outlet;
#X obj 110 146 t a a;
#X text 256 81 route keys depending on shift key;
#X text 193 282 cancel any keys playing upon shift;
#N canvas 92 117 450 300 transpose-keys 0;
#X obj 130 60 unpack 0 0;
#X obj 129 125 pack, f 9;
#X obj 197 91 * 100;
#X obj 128 93 + 48;
#X obj 144 23 inlet;
#X obj 131 168 outlet;
#X connect 0 0 3 0;
#X connect 0 1 2 0;
#X connect 1 0 5 0;
#X connect 2 0 1 1;
#X connect 3 0 1 0;
#X connect 4 0 0 0;
#X restore 126 350 pd transpose-keys;
#X text 262 348 internal keys are 0-19;
#X connect 0 0 5 0;
#X connect 2 0 9 0;
#X connect 2 1 1 0;
#X connect 3 0 6 0;
#X connect 4 0 3 0;
#X connect 5 0 2 1;
#X connect 5 1 4 0;
#X connect 6 0 12 0;
#X connect 7 0 2 0;
#X connect 9 0 12 0;
#X connect 9 1 3 0;
#X connect 12 0 8 0;
#X restore 137 323 pd shift-keys;
#X obj 590 168 v octave-transpose;
#X text 721 169 transpose for internal keyboard;
#N canvas 150 175 627 419 octave-transpose 0;
#X obj 142 44 r shift-keys;
#X obj 142 68 stripnote;
#X obj 142 92 sel 13 15;
#X obj 358 202 expr if($f1 < 24 \, $f1 + 12 \, $f1);
#X obj 92 157 v octave-transpose;
#X obj 345 163 v octave-transpose;
#X obj 278 344 s octave-transpose;
#X obj 77 197 expr if($f1 > -24 \, $f1 - 12 \, $f1);
#X obj 240 293 t b a;
#X obj 210 348 s relatch;
#X text 103 347 not yet working;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 4 0;
#X connect 2 1 5 0;
#X connect 3 0 8 0;
#X connect 4 0 7 0;
#X connect 5 0 3 0;
#X connect 7 0 8 0;
#X connect 8 0 9 0;
#X connect 8 1 6 0;
#X restore 315 193 pd octave-transpose;
#X text 706 91 0 = stopped \, 3 = playing \, 6 = rec enabled \, 1 = recording, f 79;
#N canvas 328 174 667 525 pattern-select 0;
#X obj 66 37 stripnote;
#X obj 66 13 r shift-keys;
#X msg 79 125 1, f 2;
#X msg 115 124 2, f 2;
#X msg 156 126 3, f 2;
#X msg 199 125 4, f 2;
#X msg 233 124 5, f 2;
#X msg 280 125 6, f 2;
#X msg 111 438 1;
#X obj 111 465 s, f 10;
#X obj 141 404 t b f;
#X text 445 289 turn off with fadeout;
#X obj 148 244 t f f b;
#X obj 65 82 sel 0 2 4 5 7 9, f 26;
#X obj 301 290 s pattern-disable-all;
#X obj 192 296 s pattern-num;
#X msg 191 427 symbol p\$1-enable;
#X obj 364 109 r set-pattern-num;
#X connect 0 0 13 0;
#X connect 1 0 0 0;
#X connect 2 0 12 0;
#X connect 3 0 12 0;
#X connect 4 0 12 0;
#X connect 5 0 12 0;
#X connect 6 0 12 0;
#X connect 7 0 12 0;
#X connect 8 0 9 0;
#X connect 10 0 8 0;
#X connect 10 1 16 0;
#X connect 12 0 10 0;
#X connect 12 1 15 0;
#X connect 12 2 14 0;
#X connect 13 0 2 0;
#X connect 13 1 3 0;
#X connect 13 2 4 0;
#X connect 13 3 5 0;
#X connect 13 4 6 0;
#X connect 13 5 7 0;
#X connect 16 0 9 1;
#X connect 17 0 12 0;
#X restore 315 145 pd pattern-select;
#X obj 152 484 s notes-to-pattern;
#X obj 151 524 r notes-from-pattern;
#X obj 149 598 s notes-to-synth;
#N canvas 162 265 502 526 octave-transpose 0;
#X obj 86 39 inlet;
#X obj 71 459 outlet;
#X obj 170 160 bag;
#X obj 168 191 pack 0 0;
#X obj 168 42 r octave-transpose;
#X obj 94 237 unpack;
#X obj 83 289 + 0;
#X obj 58 345 pack 0 0;
#X msg 177 124 flush;
#X obj 146 88 t f b;
#X connect 0 0 5 0;
#X connect 0 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 5 0;
#X connect 4 0 9 0;
#X connect 5 0 6 0;
#X connect 5 1 7 1;
#X connect 6 0 7 0;
#X connect 7 0 1 0;
#X connect 8 0 2 0;
#X connect 9 0 6 1;
#X connect 9 1 8 0;
#X restore 161 407 pd octave-transpose;
#N canvas 290 25 702 698 auto-load-synths 0;
#X obj 219 438 spigot 1;
#X obj 292 470 i 0;
#X obj 401 369 i 1;
#X obj 286 586 symbol s1;
#X msg 322 155 \; pd-load-synths-here clear;
#X obj 219 183 t a b;
#X obj 219 213 max 1;
#X obj 219 237 until;
#X obj 219 157 i 6;
#X obj 219 261 i;
#X obj 277 261 + 1;
#X obj 219 302 t a a b, f 26;
#X obj 346 554 makefilename s%d;
#X obj 358 490 t a a;
#X obj 281 223 i 1;
#X obj 219 522 t a b b;
#X obj 252 560 * 50;
#X obj 219 613 pack s 0 s;
#X obj 219 332 makefilename synths/%d*;
#X obj 219 91 t b b;
#X obj 184 15 bng 15 250 50 0 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000;
#X obj 218 17 r load-synths;
#X obj 107 577 print loading;
#X obj 219 364 folder_list;
#X obj 184 58 t b b;
#X obj 61 100 t b b b b b b;
#X obj 105 270 s loadbang-s1;
#X obj 73 220 s loadbang-s3;
#X obj 53 198 s loadbang-s4;
#X obj 37 172 s loadbang-s5;
#X obj 23 149 s loadbang-s6;
#X obj 88 245 s loadbang-s2;
#X msg 219 647 \; pd-load-synths-here obj 10 \$2 synth-slot \$3 \$1/module;
#X connect 0 0 15 0;
#X connect 1 0 0 1;
#X connect 2 0 0 1;
#X connect 3 0 17 2;
#X connect 5 0 6 0;
#X connect 5 1 14 0;
#X connect 6 0 7 0;
#X connect 7 0 9 0;
#X connect 8 0 5 0;
#X connect 9 0 10 0;
#X connect 9 0 11 0;
#X connect 10 0 9 1;
#X connect 11 0 18 0;
#X connect 11 1 13 0;
#X connect 11 2 2 0;
#X connect 12 0 3 1;
#X connect 13 0 16 0;
#X connect 13 1 12 0;
#X connect 14 0 9 1;
#X connect 15 0 17 0;
#X connect 15 0 22 0;
#X connect 15 1 3 0;
#X connect 15 2 1 0;
#X connect 16 0 17 1;
#X connect 17 0 32 0;
#X connect 18 0 23 0;
#X connect 19 0 8 0;
#X connect 19 1 4 0;
#X connect 20 0 24 0;
#X connect 21 0 24 0;
#X connect 23 0 0 0;
#X connect 24 0 25 0;
#X connect 24 1 19 0;
#X connect 25 0 30 0;
#X connect 25 1 29 0;
#X connect 25 2 28 0;
#X connect 25 3 27 0;
#X connect 25 4 31 0;
#X connect 25 5 26 0;
#X restore 46 82 pd auto-load-synths;
#N canvas 150 175 450 300 load-synths-here 0;
#X restore 46 107 pd load-synths-here;
#N canvas 290 25 733 686 auto-load-patterns 0;
#X obj 280 426 spigot 1;
#X obj 353 458 i 0;
#X obj 462 357 i 1;
#X obj 347 574 symbol s1;
#X obj 280 171 t a b;
#X obj 280 201 max 1;
#X obj 280 225 until;
#X obj 280 145 i 6;
#X obj 280 249 i;
#X obj 338 249 + 1;
#X obj 280 290 t a a b, f 26;
#X obj 419 478 t a a;
#X obj 342 211 i 1;
#X obj 280 510 t a b b;
#X obj 313 548 * 50;
#X obj 280 601 pack s 0 s;
#X obj 280 79 t b b;
#X obj 280 352 folder_list;
#X obj 407 542 makefilename p%d;
#X obj 280 320 makefilename patterns/%d*;
#X msg 383 143 \; pd-load-patterns-here clear;
#X obj 192 575 print loading;
#X obj 194 9 r load-patterns;
#X obj 194 33 t b b;
#X obj 71 75 t b b b b b b;
#X obj 33 124 s loadbang-p6;
#X obj 47 147 s loadbang-p5;
#X obj 115 245 s loadbang-p1;
#X obj 98 220 s loadbang-p2;
#X obj 83 195 s loadbang-p3;
#X obj 63 173 s loadbang-p4;
#X msg 280 635 \; pd-load-patterns-here obj 10 \$2 pattern-slot \$3 \$1/module;
#X connect 0 0 13 0;
#X connect 1 0 0 1;
#X connect 2 0 0 1;
#X connect 3 0 15 2;
#X connect 4 0 5 0;
#X connect 4 1 12 0;
#X connect 5 0 6 0;
#X connect 6 0 8 0;
#X connect 7 0 4 0;
#X connect 8 0 9 0;
#X connect 8 0 10 0;
#X connect 9 0 8 1;
#X connect 10 0 19 0;
#X connect 10 1 11 0;
#X connect 10 2 2 0;
#X connect 11 0 14 0;
#X connect 11 1 18 0;
#X connect 12 0 8 1;
#X connect 13 0 15 0;
#X connect 13 0 21 0;
#X connect 13 1 3 0;
#X connect 13 2 1 0;
#X connect 14 0 15 1;
#X connect 15 0 31 0;
#X connect 16 0 7 0;
#X connect 16 1 20 0;
#X connect 17 0 0 0;
#X connect 18 0 3 1;
#X connect 19 0 17 0;
#X connect 22 0 23 0;
#X connect 23 0 24 0;
#X connect 23 1 16 0;
#X connect 24 0 25 0;
#X connect 24 1 26 0;
#X connect 24 2 30 0;
#X connect 24 3 29 0;
#X connect 24 4 28 0;
#X connect 24 5 27 0;
#X restore 46 130 pd auto-load-patterns;
#N canvas 150 175 450 300 load-patterns-here 0;
#X restore 46 155 pd load-patterns-here;
#N canvas 63 88 642 303 latch-control 0;
#X obj 121 37 r shift-keys;
#X obj 121 61 stripnote;
#X obj 214 137 r seq-before-play;
#X msg 222 166 0;
#X obj 121 85 sel 3;
#X obj 121 110 v latch-state;
#X obj 129 137 sel 0 1;
#X msg 125 162 1;
#X msg 159 164 0;
#X obj 144 227 s latch-state;
#X text 273 158 disable latch when playing seq;
#X connect 0 0 1 0;
#X connect 1 0 4 0;
#X connect 2 0 3 0;
#X connect 3 0 9 0;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 6 0 7 0;
#X connect 6 1 8 0;
#X connect 7 0 9 0;
#X connect 8 0 9 0;
#X restore 315 218 pd latch-control;
#X text 620 15 globals;
#X text 156 503 pattern gen modules \, notes in notes out;
#X text 146 623 synth modules \, notes in sound out;
#N canvas 120 59 1217 721 song-save-recall-new 0;
#X obj 728 512 s totalsongs;
#X obj 766 304 r load-songs;
#X obj 419 111 r shift-keys;
#X obj 419 135 stripnote;
#N canvas 14 182 1118 546 save-state 0;
#X obj 575 476 textfile;
#X obj 281 275 v knob1;
#X obj 369 278 v knob2;
#X obj 463 275 v knob3;
#X obj 552 276 v pattern-num;
#X obj 681 276 v synth-num;
#X msg 280 304 add knob1 \$1;
#X msg 551 302 add pattern-num \$1;
#X msg 678 302 add synth-num \$1;
#X msg 983 297 clear;
#X obj 204 89 t b b;
#X msg 368 304 add knob2 \$1;
#X msg 456 305 add knob3 \$1;
#X obj 198 58 r save-state;
#X obj 500 164 t b b b b b b b, f 39;
#X obj 809 278 v octave-transpose;
#X msg 803 304 add octave-transpose \$1;
#X obj 117 262 vsym songs-root-path;
#X obj 128 228 t b b;
#X msg 117 340 write \$1/\$2/state.txt;
#X obj 160 284 v next-song-num;
#X obj 116 316 pack s f;
#X connect 1 0 6 0;
#X connect 2 0 11 0;
#X connect 3 0 12 0;
#X connect 4 0 7 0;
#X connect 5 0 8 0;
#X connect 6 0 0 0;
#X connect 7 0 0 0;
#X connect 8 0 0 0;
#X connect 9 0 0 0;
#X connect 10 0 18 0;
#X connect 10 1 14 0;
#X connect 11 0 0 0;
#X connect 12 0 0 0;
#X connect 13 0 10 0;
#X connect 14 0 1 0;
#X connect 14 1 2 0;
#X connect 14 2 3 0;
#X connect 14 3 4 0;
#X connect 14 4 5 0;
#X connect 14 5 15 0;
#X connect 14 6 9 0;
#X connect 15 0 16 0;
#X connect 16 0 0 0;
#X connect 17 0 21 0;
#X connect 18 0 17 0;
#X connect 18 1 20 0;
#X connect 19 0 0 0;
#X connect 20 0 21 1;
#X connect 21 0 19 0;
#X restore 48 56 pd save-state;
#N canvas 51 61 966 618 recall-state 0;
#X obj 246 321 textfile;
#X obj 233 262 until;
#X obj 299 96 t b b b;
#X msg 624 233 clear;
#X msg 260 141 rewind;
#X obj 718 374 s knobs-override-all;
#X obj 664 321 t b b b b;
#X obj 449 504 s knob1;
#X obj 502 503 s knob2;
#X obj 558 502 s knob3;
#X obj 452 478 f 0.5;
#X obj 500 478 f 0.5;
#X obj 560 477 f 0.5;
#X obj 241 42 t b b b;
#X obj 689 213 delay 15;
#X text 593 140 allow old synth to fade out and new one load before sending knobs, f 33;
#X obj 262 502 s set-synth-num;
#X obj 145 498 s set-pattern-num;
#X obj 238 9 r recall-state;
#X obj 226 415 route pattern-num synth-num octave-transpose knob1 knob2 knob3, f 66;
#X obj 369 531 s octave-transpose;
#X obj 132 433 print;
#X obj 325 182 vsym songs-root-path;
#X obj 368 204 vsym cursong-dir;
#X obj 326 228 pack s s;
#X obj 336 148 t b b;
#X msg 326 252 read \$1/\$2/state.txt;
#X connect 0 0 19 0;
#X connect 0 0 21 0;
#X connect 0 1 1 1;
#X connect 1 0 0 0;
#X connect 2 0 4 0;
#X connect 2 1 25 0;
#X connect 2 2 3 0;
#X connect 3 0 0 0;
#X connect 4 0 0 0;
#X connect 6 0 10 0;
#X connect 6 1 11 0;
#X connect 6 2 12 0;
#X connect 6 3 5 0;
#X connect 10 0 7 0;
#X connect 11 0 8 0;
#X connect 12 0 9 0;
#X connect 13 0 1 0;
#X connect 13 1 2 0;
#X connect 13 2 14 0;
#X connect 14 0 6 0;
#X connect 18 0 13 0;
#X connect 19 0 17 0;
#X connect 19 1 16 0;
#X connect 19 2 20 0;
#X connect 19 3 10 1;
#X connect 19 4 11 1;
#X connect 19 5 12 1;
#X connect 22 0 24 0;
#X connect 23 0 24 1;
#X connect 24 0 26 0;
#X connect 25 0 22 0;
#X connect 25 1 23 0;
#X connect 26 0 0 0;
#X restore 47 81 pd recall-state;
#N canvas 63 88 558 467 midi-pc 0;
#X obj 109 36 r midi-pc-in;
#X obj 346 91 s midi-pc-out;
#X obj 156 303 s recall-state;
#X obj 92 332 s recall-seq;
#X obj 246 179 i, f 6;
#X obj 113 267 t b b;
#X obj 248 211 s cursong-index;
#N canvas 441 25 450 300 mute-unmute 0;
#X obj 159 21 inlet;
#X obj 203 235 outlet;
#X obj 166 82 t b b;
#X obj 201 106 s mute-dac;
#X obj 162 149 t b b;
#X obj 101 239 s unmute-dac;
#X obj 162 128 delay 10;
#X obj 115 197 delay 10;
#X connect 0 0 2 0;
#X connect 2 0 6 0;
#X connect 2 1 3 0;
#X connect 4 0 7 0;
#X connect 4 1 1 0;
#X connect 6 0 4 0;
#X connect 7 0 5 0;
#X restore 115 228 pd mute-unmute;
#X obj 116 134 t b f;
#X obj 346 52 r cursong-index;
#N canvas 237 262 450 300 check-for-songs 0;
#X obj 166 97 v totalsongs;
#X obj 166 120 > 0;
#X obj 163 141 sel 1;
#X obj 166 64 inlet;
#X obj 163 184 outlet;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 4 0;
#X connect 3 0 0 0;
#X restore 115 183 pd check-for-songs;
#X connect 0 0 8 0;
#X connect 4 0 6 0;
#X connect 5 0 3 0;
#X connect 5 1 2 0;
#X connect 7 0 5 0;
#X connect 8 0 10 0;
#X connect 8 1 4 0;
#X connect 9 0 1 0;
#X connect 10 0 7 0;
#X restore 49 30 pd midi-pc;
#N canvas 441 25 450 300 mute-unmute 0;
#X obj 159 21 inlet;
#X obj 216 237 outlet;
#X obj 166 82 t b b;
#X obj 201 106 s mute-dac;
#X obj 162 149 t b b;
#X obj 118 242 s unmute-dac;
#X obj 162 128 delay 10;
#X obj 129 195 delay 10;
#X connect 0 0 2 0;
#X connect 2 0 6 0;
#X connect 2 1 3 0;
#X connect 4 0 7 0;
#X connect 4 1 1 0;
#X connect 6 0 4 0;
#X connect 7 0 5 0;
#X restore 354 249 pd mute-unmute;
#N canvas 441 25 450 300 mute-unmute 0;
#X obj 159 21 inlet;
#X obj 220 235 outlet;
#X obj 166 82 t b b;
#X obj 209 117 s mute-dac;
#X obj 141 154 t b b;
#X obj 112 251 s unmute-dac;
#X obj 132 118 delay 10;
#X obj 120 198 delay 10;
#X connect 0 0 2 0;
#X connect 2 0 6 0;
#X connect 2 1 3 0;
#X connect 4 0 7 0;
#X connect 4 1 1 0;
#X connect 6 0 4 0;
#X connect 7 0 5 0;
#X restore 731 164 pd mute-unmute;
#N canvas 441 25 450 300 mute-unmute 0;
#X obj 159 21 inlet;
#X obj 203 235 outlet;
#X obj 166 82 t b b;
#X obj 201 106 s mute-dac;
#X obj 162 149 t b b;
#X obj 101 239 s unmute-dac;
#X obj 162 128 delay 10;
#X obj 115 197 delay 10;
#X connect 0 0 2 0;
#X connect 2 0 6 0;
#X connect 2 1 3 0;
#X connect 4 0 7 0;
#X connect 4 1 1 0;
#X connect 6 0 4 0;
#X connect 7 0 5 0;
#X restore 495 247 pd mute-unmute;
#N canvas 99 119 1019 582 prev 0;
#X obj 392 423 v totalsongs;
#X obj 328 132 s recall-state;
#X obj 240 136 s recall-seq;
#X obj 233 501 s cursong-index;
#X obj 350 21 inlet;
#X obj 233 424 v cursong-index;
#X obj 431 106 v npmode;
#X obj 431 139 sel 0 1 2 3;
#X obj 348 55 t b b b;
#X obj 286 352 t b b;
#X obj 70 395 t b b;
#X msg 54 440 1;
#X obj 40 484 s npmode;
#X obj 113 478 s cursong-index;
#X msg 397 290 1;
#X obj 383 334 s npmode;
#X obj 741 279 t b b b;
#X msg 685 353 1;
#X obj 683 395 s npmode;
#X text 501 103 do prev depending on mode;
#X obj 233 446 - 1;
#X obj 233 472 expr if($f1 < 0 \, $f2 - 1 \, $f1);
#X text 517 130 0: on startup \, select last \, 1: cycle normally;
#X obj 107 426 v totalsongs;
#X obj 107 447 - 1;
#X obj 576 283 v totalsongs;
#X obj 452 358 s cursong-index;
#X obj 452 329 expr if($f1 < 0 \, $f2 - 1 \, $f1);
#X obj 452 281 v totalsongs;
#X obj 452 303 - 2;
#X obj 454 235 t b b b;
#X text 518 147 2: preset saved \, last - 1 \, 3: preset deleted \, current - 1 (just deleted) is now prev;
#X obj 901 330 v totalsongs;
#X obj 747 403 s cursong-index;
#X obj 747 326 v cursong-index;
#X obj 747 348 - 1;
#X obj 747 374 expr if($f1 < 0 \, $f2 - 1 \, $f1);
#X connect 0 0 21 1;
#X connect 4 0 8 0;
#X connect 5 0 20 0;
#X connect 6 0 7 0;
#X connect 7 0 10 0;
#X connect 7 1 9 0;
#X connect 7 2 30 0;
#X connect 7 3 16 0;
#X connect 8 0 2 0;
#X connect 8 1 1 0;
#X connect 8 2 6 0;
#X connect 9 0 5 0;
#X connect 9 1 0 0;
#X connect 10 0 11 0;
#X connect 10 1 23 0;
#X connect 11 0 12 0;
#X connect 14 0 15 0;
#X connect 16 0 17 0;
#X connect 16 1 34 0;
#X connect 16 2 32 0;
#X connect 17 0 18 0;
#X connect 20 0 21 0;
#X connect 21 0 3 0;
#X connect 23 0 24 0;
#X connect 24 0 13 0;
#X connect 25 0 27 1;
#X connect 27 0 26 0;
#X connect 28 0 29 0;
#X connect 29 0 27 0;
#X connect 30 0 14 0;
#X connect 30 1 28 0;
#X connect 30 2 25 0;
#X connect 32 0 36 1;
#X connect 34 0 35 0;
#X connect 35 0 36 0;
#X connect 36 0 33 0;
#X restore 354 286 pd prev;
#N canvas 237 262 450 300 check-for-songs 0;
#X obj 166 97 v totalsongs;
#X obj 166 120 > 0;
#X obj 163 141 sel 1;
#X obj 166 64 inlet;
#X obj 163 184 outlet;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 4 0;
#X connect 3 0 0 0;
#X restore 355 216 pd check-for-songs;
#N canvas 237 262 450 300 check-for-songs 0;
#X obj 166 97 v totalsongs;
#X obj 166 120 > 0;
#X obj 163 141 sel 1;
#X obj 166 64 inlet;
#X obj 163 184 outlet;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 4 0;
#X connect 3 0 0 0;
#X restore 494 218 pd check-for-songs;
#N canvas 509 118 805 551 next 0;
#X obj 195 427 + 1;
#X obj 354 404 v totalsongs;
#X obj 143 120 s recall-state;
#X obj 55 124 s recall-seq;
#X obj 195 482 s cursong-index;
#X obj 165 9 inlet;
#X obj 195 405 v cursong-index;
#X obj 195 453 expr if($f1 >= $f2 \, 0 \, $f1);
#X obj 246 94 v npmode;
#X obj 246 127 sel 0 1 2 3;
#X obj 163 43 t b b b;
#X obj 248 333 t b b;
#X obj 76 235 t b b;
#X msg 60 280 1;
#X obj 46 324 s npmode;
#X obj 119 318 s cursong-index;
#X msg 114 280 0;
#X text 316 91 do next depending on mode;
#X obj 333 211 t b b;
#X msg 317 256 1;
#X obj 303 300 s npmode;
#X obj 376 294 s cursong-index;
#X msg 371 256 0;
#X text 332 118 0: on startup \, select first \, 1: cycle normally;
#X obj 705 355 v totalsongs;
#X obj 546 433 s cursong-index;
#X obj 546 356 v cursong-index;
#X obj 546 404 expr if($f1 >= $f2 \, 0 \, $f1);
#X obj 599 284 t b b b;
#X msg 500 341 1;
#X obj 485 385 s npmode;
#X text 333 135 2: preset saved \, select first \, 3: preset deleted \, current (just deleted) is now next;
#X obj 224 12 r goto-next;
#X connect 0 0 7 0;
#X connect 1 0 7 1;
#X connect 5 0 10 0;
#X connect 6 0 0 0;
#X connect 7 0 4 0;
#X connect 8 0 9 0;
#X connect 9 0 12 0;
#X connect 9 1 11 0;
#X connect 9 2 18 0;
#X connect 9 3 28 0;
#X connect 10 0 3 0;
#X connect 10 1 2 0;
#X connect 10 2 8 0;
#X connect 11 0 6 0;
#X connect 11 1 1 0;
#X connect 12 0 13 0;
#X connect 12 1 16 0;
#X connect 13 0 14 0;
#X connect 16 0 15 0;
#X connect 18 0 19 0;
#X connect 18 1 22 0;
#X connect 19 0 20 0;
#X connect 22 0 21 0;
#X connect 24 0 27 1;
#X connect 26 0 27 0;
#X connect 27 0 25 0;
#X connect 28 0 29 0;
#X connect 28 1 26 0;
#X connect 28 2 24 0;
#X connect 29 0 30 0;
#X connect 32 0 10 0;
#X restore 495 281 pd next;
#N canvas 98 129 506 627 save-new 0;
#X obj 185 44 inlet;
#X obj 230 481 vsym songs-root-path;
#X obj 241 447 t b b;
#X obj 273 503 v next-song-num;
#X obj 229 535 pack s f;
#X msg 230 559 write \$1/\$2/seq.txt;
#X obj 229 588 s save-seq;
#X obj 294 443 s save-state;
#X obj 254 406 t b b;
#X obj 161 410 s load-songs;
#X text 84 223 make new dir;
#X obj 216 322 t b b b;
#X obj 313 406 s flash-all-leds;
#X obj 144 366 t b b;
#X obj 184 81 delay 7;
#X obj 118 444 s npmode;
#X msg 121 405 2;
#X obj 176 142 vsym songs-root-path;
#X obj 187 108 t b b;
#X obj 219 164 v next-song-num;
#X obj 175 196 pack s f;
#X text 82 83 wait for mute;
#X msg 181 223 mkdir \$1/\$2;
#X obj 185 283 shell;
#X obj 190 248 t a a;
#X obj 283 298 print SavingPreset;
#X text 90 345 reload song list;
#X connect 0 0 14 0;
#X connect 1 0 4 0;
#X connect 2 0 1 0;
#X connect 2 1 3 0;
#X connect 3 0 4 1;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 8 0 2 0;
#X connect 8 1 7 0;
#X connect 11 0 13 0;
#X connect 11 1 8 0;
#X connect 11 2 12 0;
#X connect 13 0 16 0;
#X connect 13 1 9 0;
#X connect 14 0 18 0;
#X connect 16 0 15 0;
#X connect 17 0 20 0;
#X connect 18 0 17 0;
#X connect 18 1 19 0;
#X connect 19 0 20 1;
#X connect 20 0 22 0;
#X connect 22 0 24 0;
#X connect 23 1 11 0;
#X connect 24 0 23 0;
#X connect 24 1 25 0;
#X restore 730 197 pd save-new;
#X obj 775 408 dirlist, f 9;
#X obj 775 451 route total_dirs next_name dirname, f 39;
#X obj 817 512 s next-song-num;
#X obj 349 466 print totalsongs;
#X obj 347 529 print next-song-num;
#X obj 927 480 symbol;
#X obj 933 513 s cursong-dir;
#X obj 986 317 r cursong-index;
#X obj 772 337 vsym songs-root-path;
#X msg 774 365 scan \$1;
#X obj 348 486 print currsong-index;
#X obj 347 555 print currsong-dir;
#X obj 31 284 v npmode;
#X obj 68 438 t b;
#X obj 68 463 v npmode;
#X obj 68 491 sel 0 1 2;
#X text 29 165 0: on startup \, next targets first \, prev targets last, f 41;
#X text 29 194 1: preset selected \, cycle normally;
#X obj 730 76 r shift-keys;
#X obj 730 100 route 8;
#X obj 413 161 sel 6 10;
#N canvas 325 106 581 527 press-hold 0;
#X obj 244 247 f;
#X obj 244 137 t f f;
#X obj 233 170 sel 1;
#X obj 243 273 sel 1;
#X obj 308 127 r shift;
#X msg 308 183 stop;
#X obj 308 157 sel 0;
#X obj 173 64 > 0;
#X obj 174 202 i;
#X obj 144 143 r shift;
#X obj 144 173 sel 0;
#X obj 86 162 sel 0;
#X obj 159 228 sel 1;
#X msg 137 258 0;
#X obj 136 288 t b f;
#X text 353 159 releasing shift stops delay;
#X obj 244 219 del 400;
#X text 244 79 is released first.;
#X obj 116 325 t b;
#X obj 150 8 inlet;
#X obj 267 422 outlet;
#X obj 118 429 outlet;
#X text 245 63 handle cases where either shift key or key;
#X text 274 14 differentiate press from long press;
#X obj 241 302 t b b;
#X msg 193 365 0;
#X obj 116 399 spigot 1;
#X text 256 361 don't let the release from long press trigger;
#X obj 179 89 t f f f f;
#X msg 181 336 1;
#X obj 192 308 sel 1;
#X text 284 456 long press;
#X text 97 456 short press (on release);
#X connect 0 0 3 0;
#X connect 1 0 2 0;
#X connect 1 1 0 1;
#X connect 2 0 16 0;
#X connect 3 0 24 0;
#X connect 4 0 6 0;
#X connect 5 0 16 0;
#X connect 6 0 5 0;
#X connect 7 0 28 0;
#X connect 8 0 12 0;
#X connect 9 0 10 0;
#X connect 10 0 8 0;
#X connect 11 0 18 0;
#X connect 12 0 13 0;
#X connect 13 0 14 0;
#X connect 14 0 18 0;
#X connect 14 1 8 1;
#X connect 16 0 0 0;
#X connect 18 0 26 0;
#X connect 19 0 7 0;
#X connect 24 0 20 0;
#X connect 24 1 25 0;
#X connect 25 0 26 1;
#X connect 26 0 21 0;
#X connect 28 0 11 0;
#X connect 28 1 8 1;
#X connect 28 2 30 0;
#X connect 28 3 1 0;
#X connect 29 0 26 1;
#X connect 30 0 29 0;
#X restore 731 134 pd press-hold;
#X obj 181 503 vsym songs-root-path;
#X obj 192 469 t b b;
#X obj 178 622 print;
#X msg 181 581 write \$1/\$2/state.txt;
#X obj 224 525 v next-song-num;
#X obj 180 557 pack s f;
#X obj 196 426 bng 15 250 50 0 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000;
#X text 993 268 cursong-index returns the directory, f 24;
#X text 740 247 load songs gets list of preset directories and returns next number and total songs, f 41;
#X text 729 47 save \, delete;
#X text 384 81 prev preset \, next preset;
#X text 27 247 3: preset deleted \, next and previous target pre-deleted presets, f 42;
#X text 28 134 4 scenarios for next/prev mode;
#X text 28 217 2: preset saved \, next targets first \, prev targets last - 1 (or first if <2), f 53;
#X obj 929 365 t f f;
#X obj 960 407 print SelectingPreset;
#X obj 701 280 bng 16 250 50 0 empty empty empty 0 -8 0 10 #fcfcfc #000000 #000000;
#X floatatom 652 377 5 0 0 0 - - - 0;
#X obj 654 543 print TotalPresets;
#X obj 908 593 print PresetDir;
#N canvas 441 25 450 300 mute-unmute 0;
#X obj 159 21 inlet;
#X obj 220 235 outlet;
#X obj 166 82 t b b;
#X obj 209 117 s mute-dac;
#X obj 141 154 t b b;
#X obj 112 251 s unmute-dac;
#X obj 132 118 delay 10;
#X obj 120 198 delay 10;
#X connect 0 0 2 0;
#X connect 2 0 6 0;
#X connect 2 1 3 0;
#X connect 4 0 7 0;
#X connect 4 1 1 0;
#X connect 6 0 4 0;
#X connect 7 0 5 0;
#X restore 845 165 pd mute-unmute;
#N canvas 65 130 506 627 delete 0;
#X obj 185 44 inlet;
#X obj 143 443 s load-songs;
#X text 84 223 make new dir;
#X obj 313 406 s flash-all-leds;
#X obj 184 81 delay 7;
#X obj 124 527 s npmode;
#X obj 176 142 vsym songs-root-path;
#X obj 187 108 t b b;
#X text 82 83 wait for mute;
#X obj 185 283 shell;
#X obj 190 248 t a a;
#X obj 283 298 print DeletingPreset;
#X msg 181 223 rm -r \$1/\$2;
#X msg 127 488 3;
#X obj 219 164 vsym cursong-dir;
#X obj 175 196 pack s s;
#X obj 246 458 s seq-control;
#X msg 250 410 stop;
#X obj 216 322 t b b b;
#X text 339 458 stop the seq;
#X obj 236 366 t b b;
#X msg 205 409 clear;
#X obj 99 389 t b b b;
#X obj 27 442 s goto-next;
#X text 42 341 reload song list and queue up next, f 17;
#X connect 0 0 4 0;
#X connect 4 0 7 0;
#X connect 6 0 15 0;
#X connect 7 0 6 0;
#X connect 7 1 14 0;
#X connect 9 1 18 0;
#X connect 10 0 9 0;
#X connect 10 1 11 0;
#X connect 12 0 10 0;
#X connect 13 0 5 0;
#X connect 14 0 15 1;
#X connect 15 0 12 0;
#X connect 17 0 16 0;
#X connect 18 0 22 0;
#X connect 18 1 20 0;
#X connect 18 2 3 0;
#X connect 20 0 21 0;
#X connect 20 1 17 0;
#X connect 21 0 16 0;
#X connect 22 0 23 0;
#X connect 22 1 13 0;
#X connect 22 2 1 0;
#X restore 845 195 pd delete;
#X connect 1 0 23 0;
#X connect 2 0 3 0;
#X connect 3 0 35 0;
#X connect 7 0 10 0;
#X connect 8 0 14 0;
#X connect 9 0 13 0;
#X connect 11 0 7 0;
#X connect 12 0 9 0;
#X connect 15 0 16 0;
#X connect 16 0 0 0;
#X connect 16 0 55 0;
#X connect 16 1 17 0;
#X connect 16 2 20 0;
#X connect 20 0 21 0;
#X connect 20 0 56 0;
#X connect 22 0 51 0;
#X connect 23 0 24 0;
#X connect 24 0 15 0;
#X connect 28 0 29 0;
#X connect 29 0 30 0;
#X connect 33 0 34 0;
#X connect 34 0 36 0;
#X connect 35 0 11 0;
#X connect 35 1 12 0;
#X connect 36 0 8 0;
#X connect 36 1 57 0;
#X connect 37 0 42 0;
#X connect 38 0 37 0;
#X connect 38 1 41 0;
#X connect 40 0 39 0;
#X connect 41 0 42 1;
#X connect 42 0 40 0;
#X connect 43 0 38 0;
#X connect 51 0 15 0;
#X connect 51 1 52 0;
#X connect 53 0 23 0;
#X connect 54 0 15 0;
#X connect 57 0 58 0;
#X restore 314 243 pd song-save-recall-new;
#X obj 589 359 v knob1;
#X obj 589 382 v knob2;
#X obj 590 406 v knob3;
#X obj 589 216 v totalsongs;
#X obj 588 333 v global-bmp;
#X text 701 383 these get stored in scenes;
#X text 705 193 songs are more like scenes: a numbered folder that contains state.txt and seq.txt (if recorded), f 45;
#N canvas 200 25 1074 613 midi 0;
#X obj 339 47 r load-midi-config;
#N canvas 283 91 575 564 set-defaults 0;
#X msg 192 84 1;
#X msg 192 106 1;
#X msg 194 228 1;
#X msg 194 250 1;
#X msg 194 272 1;
#X msg 194 295 1;
#X obj 69 31 t b;
#X obj 227 84 s midi-in-channel;
#X obj 228 107 s midi-out-channel;
#X obj 228 227 s midi-clock-in-enable;
#X obj 228 249 s midi-clock-out-enable;
#X obj 227 271 s midi-transport-in-enable;
#X obj 227 294 s midi-transport-out-enable;
#X obj 230 135 s midi-cc-knob1;
#X obj 230 157 s midi-cc-knob2;
#X obj 230 183 s midi-cc-knob3;
#X obj 62 8 inlet;
#X msg 194 134 21;
#X msg 194 156 22;
#X msg 194 182 23;
#X msg 192 338 1;
#X msg 192 360 1;
#X msg 192 382 1;
#X msg 192 405 1;
#X obj 226 337 s midi-cc-in-enable;
#X obj 226 359 s midi-cc-out-enable;
#X obj 225 381 s midi-note-in-enable;
#X obj 225 404 s midi-note-out-enable;
#X msg 193 430 1;
#X msg 193 453 1;
#X obj 226 429 s midi-pc-in-enable;
#X obj 226 452 s midi-pc-out-enable;
#X connect 0 0 7 0;
#X connect 1 0 8 0;
#X connect 2 0 9 0;
#X connect 3 0 10 0;
#X connect 4 0 11 0;
#X connect 5 0 12 0;
#X connect 6 0 0 0;
#X connect 6 0 5 0;
#X connect 6 0 4 0;
#X connect 6 0 3 0;
#X connect 6 0 2 0;
#X connect 6 0 1 0;
#X connect 6 0 17 0;
#X connect 6 0 18 0;
#X connect 6 0 19 0;
#X connect 6 0 20 0;
#X connect 6 0 29 0;
#X connect 6 0 28 0;
#X connect 6 0 23 0;
#X connect 6 0 22 0;
#X connect 6 0 21 0;
#X connect 16 0 6 0;
#X connect 17 0 13 0;
#X connect 18 0 14 0;
#X connect 19 0 15 0;
#X connect 20 0 24 0;
#X connect 21 0 25 0;
#X connect 22 0 26 0;
#X connect 23 0 27 0;
#X connect 28 0 30 0;
#X connect 29 0 31 0;
#X restore 762 165 pd set-defaults;
#N canvas 130 109 928 473 parse-midi-config 0;
#X obj 110 179 textfile;
#X msg 342 115 clear;
#X msg 215 115 read ./midi.txt;
#X obj 112 61 t b b b b;
#X msg 156 114 rewind;
#X obj 110 112 until;
#X msg 413 116 write ./midi.txt;
#X obj 112 23 inlet;
#X text 696 9 file params;
#X text 687 36 input-channel 1 \; output-channel 1 \; cc-knob1 21 \; cc-knob2 22 \; cc-knob3 23 \; clock-in-enable 1 \; clock-out-enable 1 \; transport-in-enable 1 \; transport-out-enable 1 \; note-in-enable 1 \; note-out-enable 1 \; cc-in-enable 1 \; cc-out-enable 1 \; pc-in-enable 1 \; pc-out-enable 1 \;;
#X obj 97 210 route input-channel output-channel cc-knob1 cc-knob2 cc-knob3 clock-in-enable clock-out-enable transport-in-enable transport-out-enable note-in-enable note-out-enable cc-in-enable cc-out-enable pc-in-enable pc-out-enable, f 61;
#X obj 42 311 s midi-in-channel;
#X obj 69 334 s midi-out-channel;
#X obj 217 311 s midi-clock-in-enable;
#X obj 229 331 s midi-clock-out-enable;
#X obj 252 355 s midi-transport-in-enable;
#X obj 276 377 s midi-transport-out-enable;
#X obj 94 357 s midi-cc-knob1;
#X obj 119 380 s midi-cc-knob2;
#X obj 153 405 s midi-cc-knob3;
#X obj 403 307 s midi-cc-in-enable;
#X obj 443 334 s midi-cc-out-enable;
#X obj 306 408 s midi-note-in-enable;
#X obj 336 438 s midi-note-out-enable;
#X obj 521 384 s midi-pc-in-enable;
#X obj 553 404 s midi-pc-out-enable;
#X connect 0 0 10 0;
#X connect 0 1 5 1;
#X connect 1 0 0 0;
#X connect 2 0 0 0;
#X connect 3 0 5 0;
#X connect 3 1 4 0;
#X connect 3 2 2 0;
#X connect 3 3 1 0;
#X connect 4 0 0 0;
#X connect 5 0 0 0;
#X connect 6 0 0 0;
#X connect 7 0 3 0;
#X connect 10 0 11 0;
#X connect 10 1 12 0;
#X connect 10 2 17 0;
#X connect 10 3 18 0;
#X connect 10 4 19 0;
#X connect 10 5 13 0;
#X connect 10 6 14 0;
#X connect 10 7 15 0;
#X connect 10 8 16 0;
#X connect 10 9 22 0;
#X connect 10 10 23 0;
#X connect 10 11 20 0;
#X connect 10 12 21 0;
#X connect 10 13 24 0;
#X connect 10 14 25 0;
#X restore 507 164 pd parse-midi-config;
#N canvas 759 213 450 300 create-midi-obj 0;
#X obj 38 192 pack 0 0 0 0 0;
#X obj 55 42 t b b b b b b;
#X obj 71 133 v midi-out-channel;
#X obj 51 156 v midi-in-channel;
#X obj 88 113 v midi-cc-knob1;
#X obj 101 92 v midi-cc-knob2;
#X obj 114 71 v midi-cc-knob3;
#X obj 44 16 inlet;
#X msg 15 233 \; pd-load-midi-obj-here obj 10 10 midiio \$1 \$2 \$3 \$4 \$5;
#X msg 233 70 \; pd-load-midi-obj-here clear;
#X connect 0 0 8 0;
#X connect 1 0 3 0;
#X connect 1 1 2 0;
#X connect 1 2 4 0;
#X connect 1 3 5 0;
#X connect 1 4 6 0;
#X connect 1 5 9 0;
#X connect 2 0 0 1;
#X connect 3 0 0 0;
#X connect 4 0 0 2;
#X connect 5 0 0 3;
#X connect 6 0 0 4;
#X connect 7 0 1 0;
#X restore 279 165 pd create-midi-obj;
#N canvas 308 78 254 71 load-midi-obj-here 0;
#X obj 10 10 midiio 1 1 21 22 23;
#X restore 276 235 pd load-midi-obj-here;
#X text 538 140 get values from file;
#X text 300 135 create midi object using values, f 23;
#X text 475 37 note \, cc \, and pgm are created dynamically with values from config, f 34;
#X text 865 151 set defualt values in case there is problem with file, f 23;
#X obj 159 367 midirealtimein;
#X obj 162 396 sel 248 250 251 252 254, f 38;
#X obj 699 508 midiout;
#X msg 586 416 248;
#X msg 710 409 250;
#X msg 826 412 252;
#X obj 300 485 s midi-start-in;
#X obj 710 387 r midi-start-out;
#X obj 587 386 r midi-clock-out;
#X obj 826 390 r midi-stop-out;
#X obj 608 473 spigot;
#X obj 777 458 spigot;
#X obj 614 435 r midi-clock-out-enable;
#X obj 827 438 r midi-transport-out-enable;
#X obj 375 419 r midi-transport-in-enable;
#X obj 198 426 r midi-clock-in-enable;
#X obj 286 460 spigot;
#X obj 399 488 s midi-stop-in;
#X obj 400 458 spigot;
#X obj 176 472 spigot;
#X obj 170 504 s midi-clock-in;
#N canvas 283 91 575 689 set-spigots 0;
#X obj 69 31 t b;
#X obj 226 122 s midi-clock-in-enable;
#X obj 62 8 inlet;
#X obj 226 101 v midi-clock-in-enable;
#X obj 225 173 s midi-clock-out-enable;
#X obj 224 220 s midi-transport-in-enable;
#X obj 226 389 s midi-cc-out-enable;
#X obj 228 446 s midi-note-in-enable;
#X obj 226 500 s midi-note-out-enable;
#X obj 226 551 s midi-pc-in-enable;
#X obj 224 607 s midi-pc-out-enable;
#X obj 225 150 v midi-clock-out-enable;
#X obj 224 199 v midi-transport-in-enable;
#X obj 224 254 v midi-transport-out-enable;
#X obj 226 307 v midi-cc-in-enable;
#X obj 226 365 v midi-cc-out-enable;
#X obj 225 276 s midi-transport-out-enable;
#X obj 227 327 s midi-cc-in-enable;
#X obj 226 426 v midi-note-in-enable;
#X obj 227 480 v midi-note-out-enable;
#X obj 226 532 v midi-pc-in-enable;
#X obj 224 586 v midi-pc-out-enable;
#X connect 0 0 3 0;
#X connect 0 0 11 0;
#X connect 0 0 12 0;
#X connect 0 0 13 0;
#X connect 0 0 14 0;
#X connect 0 0 15 0;
#X connect 0 0 18 0;
#X connect 0 0 19 0;
#X connect 0 0 20 0;
#X connect 0 0 21 0;
#X connect 2 0 0 0;
#X connect 3 0 1 0;
#X connect 11 0 4 0;
#X connect 12 0 5 0;
#X connect 13 0 16 0;
#X connect 14 0 17 0;
#X connect 15 0 6 0;
#X connect 18 0 7 0;
#X connect 19 0 8 0;
#X connect 20 0 9 0;
#X connect 21 0 10 0;
#X restore 125 168 pd set-spigots;
#X obj 319 79 t b b b b;
#X text 467 322 clock and transport;
#X text 426 234 notein \, cc \, pc loaded here;
#X text 381 346 248 = clock 250 = start 252 = stop;
#X text 41 130 send out the spigot values;
#X text 12 146 (again \, now that midi object is created);
#X connect 0 0 31 0;
#X connect 9 0 10 0;
#X connect 10 0 28 0;
#X connect 10 1 25 0;
#X connect 10 3 27 0;
#X connect 12 0 19 0;
#X connect 13 0 20 0;
#X connect 14 0 20 0;
#X connect 16 0 13 0;
#X connect 17 0 12 0;
#X connect 18 0 14 0;
#X connect 19 0 11 0;
#X connect 20 0 11 0;
#X connect 21 0 19 1;
#X connect 22 0 20 1;
#X connect 23 0 27 1;
#X connect 23 0 25 1;
#X connect 24 0 28 1;
#X connect 25 0 15 0;
#X connect 27 0 26 0;
#X connect 28 0 29 0;
#X connect 31 0 30 0;
#X connect 31 1 3 0;
#X connect 31 2 2 0;
#X connect 31 3 1 0;
#X restore 314 269 pd midi;
#N canvas 8 50 513 685 latch-notes 0;
#N canvas 590 57 817 631 latcher 0;
#X obj 215 473 bag;
#X msg 317 311 flush;
#X obj 169 81 t a a, f 17;
#X obj 285 257 t a b;
#X obj 169 44 inlet;
#X obj 331 570 outlet;
#X obj 443 58 inlet;
#X obj 285 126 stripnote;
#X obj 285 228 pack, f 9;
#X obj 443 142 t b;
#X obj 169 123 unpack;
#X obj 169 156 swap, f 6;
#X obj 169 188 pack, f 6;
#X obj 169 225 route 0;
#X obj 169 261 pack 0 100;
#X obj 545 58 inlet;
#X obj 546 102 t b b b;
#X text 496 33 relatch flushes original \, then 'replays' them;
#X obj 215 495 pack 0 0;
#X connect 0 0 18 0;
#X connect 1 0 0 0;
#X connect 2 0 10 0;
#X connect 2 1 7 0;
#X connect 3 0 5 0;
#X connect 3 1 1 0;
#X connect 4 0 2 0;
#X connect 6 0 9 0;
#X connect 7 0 8 0;
#X connect 7 1 8 1;
#X connect 8 0 3 0;
#X connect 9 0 1 0;
#X connect 10 0 11 0;
#X connect 10 1 11 1;
#X connect 11 0 12 0;
#X connect 11 1 12 1;
#X connect 12 0 13 0;
#X connect 13 0 14 0;
#X connect 14 0 0 0;
#X connect 15 0 16 0;
#X connect 18 0 5 0;
#X restore 43 413 pd latcher;
#X obj 173 298 spigot 1;
#X obj 43 298 spigot 0;
#X obj 226 272 == 0;
#X obj 43 626 outlet;
#X obj 43 106 inlet;
#X text 296 115 bang enable / disables latch;
#X text 44 53 incoming notes get sent through latch if enabled \, or directly to output if disabled;
#X obj 309 298 b;
#X obj 193 159 t f f b, f 17;
#X obj 202 116 r latch-state;
#X obj 366 301 r relatch;
#X connect 0 0 4 0;
#X connect 1 0 4 0;
#X connect 2 0 0 0;
#X connect 3 0 1 1;
#X connect 5 0 2 0;
#X connect 5 0 1 0;
#X connect 8 0 0 1;
#X connect 9 0 2 1;
#X connect 9 1 3 0;
#X connect 9 2 8 0;
#X connect 10 0 9 0;
#X connect 11 0 0 2;
#X restore 154 367 pd latch-notes;
#N canvas 53 44 1262 729 seq-control 0;
#X msg 299 472 arm, f 4;
#X obj 198 143 r shift-keys;
#X obj 148 349 v seq-state;
#X msg 171 411 stop;
#X obj 126 412 t b b;
#X obj 136 462 s seq-before-play;
#X obj 571 203 v seq-state;
#X obj 567 239 sel 6;
#X obj 572 144 r shift;
#X obj 572 174 sel 1;
#X obj 198 167 route 1;
#X obj 149 382 sel 0 3;
#X obj 919 155 r save-seq;
#X obj 919 190 t a b;
#X obj 955 229 v seq-state;
#X obj 948 256 sel 6 1;
#X msg 935 286 stop;
#X text 1015 255 if for some reason it was recording or rec en \, stop first, f 15;
#X obj 918 388 r recall-seq;
#X msg 96 487 start-sync;
#X msg 347 473 clear;
#X obj 886 335 s seq-control;
#X msg 568 269 stop;
#X obj 567 298 s seq-control;
#X msg 1134 530 stop;
#X obj 1007 655 s seq-control;
#X obj 783 473 t b b;
#X obj 814 522 s seq-before-play;
#X msg 774 551 start-sync;
#X obj 318 506 s seq-control;
#X obj 308 441 t b b;
#X obj 555 491 t b b;
#X obj 592 527 s seq-before-play;
#X msg 556 558 start-sync;
#X obj 556 383 r shift;
#X obj 556 406 sel 1;
#X obj 556 431 v seq-state;
#X obj 555 459 sel 1;
#X obj 553 593 s seq-control;
#X text 300 144 press and hold to arm.;
#X obj 163 530 s seq-control;
#X text 908 112 save and recall;
#X text 58 9 seq-state is: 0 = stopped \, 3 = playing \, 6 = rec enabled \, 1 = recording, f 80;
#X text 562 113 pressing shift while armed always disamrs;
#X text 546 358 shift pressed while recording stops and plays;
#X text 274 169 seq is played / stopped on key up;
#N canvas 92 117 794 406 midi-transport 0;
#X obj 89 53 r midi-start-in;
#X obj 87 81 v seq-state;
#X obj 87 102 sel 0;
#X obj 90 127 t b b;
#X obj 99 163 s seq-before-play;
#X msg 91 194 start-sync;
#X obj 89 220 s seq-control;
#X text 88 31 midi start;
#X obj 285 86 v seq-state;
#X obj 285 218 s seq-control;
#X obj 285 56 r midi-stop-in;
#X obj 285 107 sel 3;
#X msg 285 134 stop;
#X text 284 34 midi stop;
#X obj 472 96 r seq-state;
#X obj 472 127 sel 0 3;
#X obj 460 211 s midi-stop-out;
#X obj 609 134 r seq1-seq-starting;
#X obj 602 209 s midi-start-out;
#N canvas 510 246 450 300 once 0;
#X obj 114 61 inlet;
#X obj 203 37 inlet;
#X obj 114 215 outlet;
#X obj 114 137 == 1;
#X obj 114 115 i 0;
#X obj 114 162 sel 1;
#X obj 114 184 t b b;
#X msg 206 152 0;
#X msg 203 62 1;
#X text 252 38 reset;
#X connect 0 0 4 0;
#X connect 1 0 8 0;
#X connect 3 0 5 0;
#X connect 4 0 3 0;
#X connect 5 0 6 0;
#X connect 6 0 2 0;
#X connect 6 1 7 0;
#X connect 7 0 4 1;
#X connect 8 0 4 1;
#X restore 607 173 pd once;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 5 0;
#X connect 3 1 4 0;
#X connect 5 0 6 0;
#X connect 8 0 11 0;
#X connect 10 0 8 0;
#X connect 11 0 12 0;
#X connect 12 0 9 0;
#X connect 14 0 15 0;
#X connect 15 0 16 0;
#X connect 15 1 19 1;
#X connect 17 0 19 0;
#X connect 19 0 18 0;
#X restore 712 57 pd midi-transport;
#X obj 934 502 vsym songs-root-path;
#X obj 977 524 vsym cursong-dir;
#X obj 935 548 pack s s;
#X obj 945 468 t b b;
#X obj 919 418 t b b b;
#X msg 935 572 read \$1/\$2/seq.txt;
#N canvas 482 224 581 397 press-hold 0;
#X obj 244 247 f;
#X obj 244 137 t f f;
#X obj 233 170 sel 1;
#X obj 243 273 sel 1;
#X obj 308 127 r shift;
#X msg 308 183 stop;
#X obj 308 157 sel 0;
#X obj 173 64 > 0;
#X obj 178 202 i;
#X obj 148 143 r shift;
#X obj 148 173 sel 0;
#X obj 86 162 sel 0;
#X obj 163 228 sel 1;
#X msg 141 258 0;
#X obj 179 89 t f f f;
#X obj 140 288 t b f;
#X text 353 159 releasing shift stops delay;
#X obj 244 219 del 400;
#X text 244 79 is released first.;
#X obj 116 325 t b;
#X obj 241 302 t b;
#X obj 150 8 inlet;
#X obj 265 346 outlet;
#X obj 114 352 outlet;
#X text 245 63 handle cases where either shift key or key;
#X text 274 14 differentiate press from long press;
#X text 276 376 long press;
#X text 89 376 short press (on release);
#X connect 0 0 3 0;
#X connect 1 0 2 0;
#X connect 1 1 0 1;
#X connect 2 0 17 0;
#X connect 3 0 20 0;
#X connect 4 0 6 0;
#X connect 5 0 17 0;
#X connect 6 0 5 0;
#X connect 7 0 14 0;
#X connect 8 0 12 0;
#X connect 9 0 10 0;
#X connect 10 0 8 0;
#X connect 11 0 19 0;
#X connect 12 0 13 0;
#X connect 13 0 15 0;
#X connect 14 0 11 0;
#X connect 14 1 8 1;
#X connect 14 2 1 0;
#X connect 15 0 19 0;
#X connect 15 1 8 1;
#X connect 17 0 0 0;
#X connect 19 0 23 0;
#X connect 20 0 22 0;
#X connect 21 0 7 0;
#X restore 197 222 pd press-hold;
#X connect 0 0 29 0;
#X connect 1 0 10 0;
#X connect 2 0 11 0;
#X connect 3 0 40 0;
#X connect 4 0 19 0;
#X connect 4 1 5 0;
#X connect 6 0 7 0;
#X connect 7 0 22 0;
#X connect 8 0 9 0;
#X connect 9 0 6 0;
#X connect 10 0 53 0;
#X connect 11 0 4 0;
#X connect 11 1 3 0;
#X connect 12 0 13 0;
#X connect 13 0 21 0;
#X connect 13 1 14 0;
#X connect 14 0 15 0;
#X connect 15 0 16 0;
#X connect 15 1 16 0;
#X connect 16 0 21 0;
#X connect 18 0 51 0;
#X connect 19 0 40 0;
#X connect 20 0 29 0;
#X connect 22 0 23 0;
#X connect 24 0 25 0;
#X connect 26 0 28 0;
#X connect 26 1 27 0;
#X connect 28 0 25 0;
#X connect 30 0 0 0;
#X connect 30 1 20 0;
#X connect 31 0 33 0;
#X connect 31 1 32 0;
#X connect 33 0 38 0;
#X connect 34 0 35 0;
#X connect 35 0 36 0;
#X connect 36 0 37 0;
#X connect 37 0 31 0;
#X connect 47 0 49 0;
#X connect 48 0 49 1;
#X connect 49 0 52 0;
#X connect 50 0 47 0;
#X connect 50 1 48 0;
#X connect 51 0 26 0;
#X connect 51 1 50 0;
#X connect 51 2 24 0;
#X connect 52 0 25 0;
#X connect 53 0 2 0;
#X connect 53 1 30 0;
#X restore 313 293 pd seq-control;
#X obj 35 319 r midi-note-in;
#X obj 38 594 s midi-note-out;
#N canvas 150 175 450 300 click 0;
#X obj 223 125 tgl 15 0 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000 0 1;
#N canvas 162 161 1107 634 metro 0;
#X obj 212 537 outlet~;
#X obj 369 205 spigot 0;
#X obj 418 366 loadbang;
#X obj 475 40 inlet;
#X obj 291 33 inlet;
#X obj 203 415 tick metro1.wav \$1;
#X obj 210 472 *~ 0.2;
#X connect 1 0 5 0;
#X connect 2 0 5 1;
#X connect 3 0 1 1;
#X connect 4 0 1 0;
#X connect 5 0 6 0;
#X connect 6 0 0 0;
#X restore 178 166 pd metro;
#X obj 154 239 throw~ outL;
#X obj 241 242 throw~ outR;
#X obj 223 83 sel 18;
#X obj 222 57 stripnote;
#X obj 222 26 r shift-keys;
#X obj 115 99 sel 0;
#X obj 113 62 r beat-clock;
#X connect 0 0 1 1;
#X connect 1 0 2 0;
#X connect 1 0 3 0;
#X connect 4 0 0 0;
#X connect 5 0 4 0;
#X connect 6 0 5 0;
#X connect 7 0 1 0;
#X connect 8 0 7 0;
#X restore 313 315 pd click;
#X obj 183 686 *~;
#X obj 230 686 *~;
#X obj 388 564 r mute-dac;
#X obj 462 565 r unmute-dac;
#X obj 400 632 line~, f 10;
#X msg 382 599 0 7;
#X msg 415 600 1 7;
#N canvas 92 117 511 477 license 0;
#X text 19 14 Unless otherwise noted \, all files are copyright Critter & Guitari and can be distributed freely according the terms of the BSD 3-Clause License below. Where files have been imported from other sources \, comments in those files indicate the authors and applicable license. --- Begin BSD 3-Clause License --- Copyright (c) 2023 \, Critter & Guitari All rights reserved. Redistribution and use in source and binary forms \, with or without modification \, are permitted provided that the following conditions are met: 1 Redistributions of source code must retain the above copyright notice \, this list of conditions and the following disclaimer. 2 Redistributions in binary form must reproduce the above copyright notice \, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution. 3 Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission. THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES \, INCLUDING \, BUT NOT LIMITED TO \, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT \, INDIRECT \, INCIDENTAL \, SPECIAL \, EXEMPLARY \, OR CONSEQUENTIAL DAMAGES (INCLUDING \, BUT NOT LIMITED TO \, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES \; LOSS OF USE \, DATA \, OR PROFITS \; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY \, WHETHER IN CONTRACT \, STRICT LIABILITY \, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE \, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.;
#X restore 46 178 pd license;
#N canvas 134 71 1239 621 oscio 0;
#X obj 70 209 udpsend;
#X obj 95 174 packOSC;
#X obj 252 154 udpreceive;
#X obj 252 176 unpackOSC;
#X obj 252 204 s oscIn;
#X obj 92 145 r oscOut;
#X msg 70 119 connect localhost 4001;
#X msg 252 124 port 4000;
#X msg 12 66 connect 192.168.1.129 4001;
#X msg 161 183 disconnect;
#X obj 70 235 sel 1;
#X obj 70 272 s net-connected;
#X obj 181 30 r osc-init, f 11;
#X text 55 25 connect osc;
#X obj 417 50 r oscIn;
#X obj 568 415 / 255;
#X obj 627 414 / 255;
#X obj 687 410 / 255;
#X obj 748 409 / 255;
#X obj 576 160 unpack 0 0 0 0, f 26;
#X obj 733 124 s shift;
#X obj 633 451 s knob1;
#X obj 697 448 s knob2;
#X obj 758 450 s knob3;
#X obj 417 132 s keys;
#X obj 417 89 routeOSC /key /knobs /shift, f 68;
#X obj 551 450 s tempo-knob;
#X obj 507 339 override 10;
#X obj 623 339 override 10;
#X obj 750 335 override 10;
#X obj 834 335 override 10;
#X obj 443 212 r knobs-override-all;
#X obj 443 233 t b b b b;
#X obj 687 272 r knob1-override;
#X obj 813 270 r knob2-override;
#X obj 926 272 r knob3-override;
#X connect 0 0 10 0;
#X connect 1 0 0 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 5 0 1 0;
#X connect 6 0 0 0;
#X connect 7 0 2 0;
#X connect 8 0 0 0;
#X connect 9 0 0 0;
#X connect 10 0 11 0;
#X connect 12 0 6 0;
#X connect 12 0 7 0;
#X connect 14 0 25 0;
#X connect 15 0 26 0;
#X connect 16 0 21 0;
#X connect 17 0 22 0;
#X connect 18 0 23 0;
#X connect 19 0 27 0;
#X connect 19 1 28 0;
#X connect 19 2 29 0;
#X connect 19 3 30 0;
#X connect 25 0 24 0;
#X connect 25 1 19 0;
#X connect 25 2 20 0;
#X connect 27 0 15 0;
#X connect 28 0 16 0;
#X connect 29 0 17 0;
#X connect 30 0 18 0;
#X connect 31 0 32 0;
#X connect 32 0 27 1;
#X connect 32 1 28 1;
#X connect 32 2 29 1;
#X connect 32 3 30 1;
#X connect 33 0 28 1;
#X connect 34 0 29 1;
#X connect 35 0 30 1;
#X restore 315 70 pd oscio;
#N canvas 136 25 1086 744 sequecner 0;
#X obj 148 320 r beat-clock;
#X obj 180 396 t f f;
#X obj 490 633 change -1;
#X msg 461 588 1;
#X msg 564 594 3;
#X msg 611 596 0;
#X msg 516 583 6;
#X obj 293 95 inlet;
#X obj 367 187 stripnote;
#X obj 311 383 spigot 0;
#N canvas 510 246 450 300 once 0;
#X obj 114 61 inlet;
#X obj 203 37 inlet;
#X obj 114 215 outlet;
#X obj 114 137 == 1;
#X obj 114 115 i 0;
#X obj 114 162 sel 1;
#X obj 114 184 t b b;
#X msg 206 152 0;
#X msg 203 62 1;
#X text 252 38 reset;
#X connect 0 0 4 0;
#X connect 1 0 8 0;
#X connect 3 0 5 0;
#X connect 4 0 3 0;
#X connect 5 0 6 0;
#X connect 6 0 2 0;
#X connect 6 1 7 0;
#X connect 7 0 4 1;
#X connect 8 0 4 1;
#X restore 379 269 pd once;
#X obj 379 239 t b;
#X msg 380 298 1;
#X obj 297 132 t a a;
#X msg 461 293 0;
#X text 579 671 states are: 0 = stopped \, 3 = playing \, 6 = rec enabled \, 1 = recording, f 70;
#X obj 486 672 s seq-state;
#X obj 190 488 seq seq1, f 28;
#X obj 465 550 route rec arm start start-sync stop;
#X text 343 95 notes in;
#X obj 355 441 r seq-control;
#X obj 456 186 r seq-state;
#X obj 458 212 sel 6;
#X obj 452 238 t b b;
#X text 492 239 set it up upon entering armed state;
#X text 673 595 set seq state from the status spit out from seq;
#X obj 311 331 seq-format-event note;
#N canvas 72 96 605 496 flush-stuck-notes 0;
#X obj 167 212 bag;
#X msg 203 161 flush;
#X msg 160 254 \$1 0;
#X obj 124 157 t a a;
#X obj 137 354 outlet;
#X obj 101 22 inlet;
#X obj 258 20 inlet;
#X obj 238 107 bang;
#X obj 248 61 route end stop;
#X connect 0 0 2 0;
#X connect 1 0 0 0;
#X connect 2 0 4 0;
#X connect 3 0 4 0;
#X connect 3 1 0 0;
#X connect 5 0 3 0;
#X connect 6 0 8 0;
#X connect 7 0 1 0;
#X connect 8 0 7 0;
#X connect 8 1 7 0;
#X restore 216 620 pd flush-stuck-notes;
#X f 29;
#X obj 185 530 route note knob1 knob2 knob3;
#N canvas 50 25 1175 457 knobs 0;
#X obj 58 236 seq-format-event knob1;
#X obj 57 36 r knob1;
#X obj 228 35 r knob2;
#X obj 399 37 r knob3;
#X obj 229 235 seq-format-event knob2;
#X obj 407 235 seq-format-event knob3;
#X obj 215 320 outlet;
#X obj 57 68 change -1;
#X obj 228 65 change -1;
#X obj 399 66 change -1;
#X obj 728 43 r seq-state;
#X obj 730 69 sel 6;
#X text 474 64 don't record redundant;
#X obj 452 160 override 0.03;
#X obj 399 96 t f f;
#X obj 228 95 t f f;
#X obj 57 96 t f f;
#X obj 263 162 override 0.03;
#X obj 98 161 override 0.03;
#X obj 546 310 outlet;
#X text 777 65 when armed capture knob values \, when either of them change 0.03 \, send a bang to start the recording;
#X connect 0 0 6 0;
#X connect 1 0 7 0;
#X connect 2 0 8 0;
#X connect 3 0 9 0;
#X connect 4 0 6 0;
#X connect 5 0 6 0;
#X connect 7 0 16 0;
#X connect 8 0 15 0;
#X connect 9 0 14 0;
#X connect 10 0 11 0;
#X connect 11 0 13 1;
#X connect 11 0 17 1;
#X connect 11 0 18 1;
#X connect 13 1 19 0;
#X connect 14 0 5 0;
#X connect 14 1 13 0;
#X connect 15 0 4 0;
#X connect 15 1 17 0;
#X connect 16 0 0 0;
#X connect 16 1 18 0;
#X connect 17 1 19 0;
#X connect 18 1 19 0;
#X restore 179 116 pd knobs;
#X obj 217 665 outlet;
#N canvas 120 426 660 328 send-knobs 0;
#X obj 134 79 inlet;
#X obj 134 187 s knob1;
#X obj 166 149 s knob1-override;
#X obj 276 82 inlet;
#X obj 428 89 inlet;
#X obj 308 152 s knob2-override;
#X obj 460 159 s knob3-override;
#X obj 428 197 s knob3;
#X obj 276 190 s knob2;
#X obj 135 104 t f b;
#X obj 277 107 t f b;
#X obj 429 114 t f b;
#X connect 0 0 9 0;
#X connect 3 0 10 0;
#X connect 4 0 11 0;
#X connect 9 0 1 0;
#X connect 9 1 2 0;
#X connect 10 0 8 0;
#X connect 10 1 5 0;
#X connect 11 0 7 0;
#X connect 11 1 6 0;
#X restore 233 574 pd send-knobs;
#X text 376 147 only start with a note on or knob movement;
#X connect 0 0 1 0;
#X connect 1 0 17 0;
#X connect 1 1 17 1;
#X connect 2 0 16 0;
#X connect 3 0 2 0;
#X connect 4 0 2 0;
#X connect 5 0 2 0;
#X connect 6 0 2 0;
#X connect 7 0 13 0;
#X connect 8 0 11 0;
#X connect 9 0 17 2;
#X connect 10 0 12 0;
#X connect 11 0 10 0;
#X connect 12 0 9 1;
#X connect 13 0 26 0;
#X connect 13 1 8 0;
#X connect 14 0 9 1;
#X connect 17 0 28 0;
#X connect 17 1 18 0;
#X connect 17 1 27 1;
#X connect 18 0 3 0;
#X connect 18 1 6 0;
#X connect 18 2 4 0;
#X connect 18 3 4 0;
#X connect 18 4 5 0;
#X connect 20 0 17 3;
#X connect 21 0 22 0;
#X connect 22 0 23 0;
#X connect 23 0 10 1;
#X connect 23 1 14 0;
#X connect 26 0 9 0;
#X connect 27 0 30 0;
#X connect 28 0 27 0;
#X connect 28 1 31 0;
#X connect 28 2 31 1;
#X connect 28 3 31 2;
#X connect 29 0 9 0;
#X connect 29 1 11 0;
#X restore 184 563 pd sequecner;
#X obj 587 261 vsym songs-root-path;
#X text 719 261 stores root path of songs;
#X obj 589 193 v cursong-index;
#X obj 587 283 vsym cursong-dir;
#X text 717 286 directory of current song;
#X obj 589 239 v next-song-num;
#X text 709 237 next available song number;
#X obj 589 307 v npmode;
#X text 700 308 bahavior of preset next / prev (see pd song save recall);
#X connect 0 0 51 0;
#X connect 1 0 52 0;
#X connect 13 0 19 0;
#X connect 19 0 46 0;
#X connect 26 0 27 0;
#X connect 26 0 49 0;
#X connect 26 0 60 0;
#X connect 28 0 25 0;
#X connect 46 0 28 0;
#X connect 48 0 46 0;
#X connect 51 0 2 0;
#X connect 52 0 2 1;
#X connect 53 0 56 0;
#X connect 54 0 57 0;
#X connect 55 0 52 1;
#X connect 55 0 51 1;
#X connect 56 0 55 0;
#X connect 57 0 55 0;
#X connect 60 0 27 0;
#X connect 60 0 49 0;
